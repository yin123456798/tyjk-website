<html lang="zh-CN">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <title>
   ä¸ªäººä¸­å¿ƒ - å¤©æ¶¯æå®¢ç¤¾å›¢
  </title>
  <script src="https://res.gemcoder.com/js/reload.js">
  </script>
  <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
  <script src="https://cdn.tailwindcss.com">
  </script>
  <link href="https://cdn.bootcdn.net/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet"/>
  <script src="./supabase-config.js"></script>
  <script>
   tailwind.config = {
  theme: {
    extend: {
      colors: {
        primary: '#165DFF',
        secondary: '#6B7280',
        accent: '#3B82F6',
        light: '#F3F4F6',
        dark: '#1F2937',
        success: '#10B981',
        warning: '#F59E0B',
        danger: '#EF4444',
        'red-600': '#DC2626',
        'blue-600': '#2563EB',
        'green-600': '#16A34A',
        'purple-600': '#9333EA'
      },
      fontFamily: {
        sans: ['Inter', 'system-ui', 'sans-serif']
      }
    }
  }
};
  </script>
  <style type="text/tailwindcss">
   @layer utilities {
            .content-auto {
                content-visibility: auto;
            }
            .form-input-focus {
                @apply focus:ring-2 focus:ring-primary/50 focus:border-primary transition duration-200;
            }
            .btn-primary {
                @apply bg-primary text-white py-2 px-4 rounded-md hover:bg-primary/90 transition duration-200 shadow-sm hover:shadow;
            }
            .btn-secondary {
                @apply bg-white text-primary border border-primary py-2 px-4 rounded-md hover:bg-primary/5 transition duration-200;
            }
            .card-shadow {
                @apply shadow-md hover:shadow-lg transition-shadow duration-300;
            }
            .gradient-bg {
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            }
            .glass-effect {
                backdrop-filter: blur(10px);
                background: rgba(255, 255, 255, 0.9);
            }
        }
  </style>
 </head>
 <body class="bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 font-sans text-dark min-h-screen">
  <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
  <header class="glass-effect shadow-sm sticky top-0 z-10 border-b border-white/20">
   <div class="container mx-auto px-4 sm:px-6 lg:px-8">
    <div class="flex justify-between items-center h-16">
     <div class="flex items-center">
      <a href="./index.html" class="text-xl font-bold text-primary flex items-center">
       <i class="fas fa-users mr-2"></i>
       å¤©æ¶¯æå®¢ç¤¾å›¢
      </a>
     </div>
     <div class="flex items-center space-x-4">
      <span id="user-name" class="text-secondary font-medium">ç”¨æˆ·å</span>
      <button class="text-secondary hover:text-primary transition-colors duration-200 flex items-center bg-white/50 px-3 py-1 rounded-full" id="logoutBtn">
       <i class="fas fa-sign-out-alt mr-2">
       </i>
       é€€å‡º
      </button>
     </div>
    </div>
   </div>
  </header>

  <!-- ä¸»å†…å®¹åŒº -->
  <main class="container mx-auto px-4 sm:px-6 lg:px-8 py-8">
   <div class="max-w-7xl mx-auto">
    <!-- é¡µé¢æ ‡é¢˜ -->
    <div class="mb-8 text-center">
     <h1 class="text-[clamp(2rem,5vw,3rem)] font-bold text-dark mb-4">
      ä¸ªäººä¸­å¿ƒ
     </h1>
     <p class="text-secondary text-lg max-w-2xl mx-auto">
      ç®¡ç†æ‚¨çš„ä¸ªäººä¿¡æ¯ã€ç¤¾å›¢æ´»åŠ¨å’Œé¡¹ç›®å‚ä¸
     </p>
    </div>

    <!-- ä¸»è¦å†…å®¹åŒºåŸŸ -->
    <div class="grid grid-cols-1 xl:grid-cols-4 gap-8">
      
      <!-- å·¦ä¾§è¾¹æ  - ç”¨æˆ·ä¿¡æ¯å’Œå¿«æ·æ“ä½œ -->
      <div class="xl:col-span-1 space-y-6">
        
        <!-- ç”¨æˆ·ä¿¡æ¯å¡ç‰‡ -->
        <div class="bg-white/80 backdrop-blur-sm rounded-2xl p-6 card-shadow border border-white/20">
          <div class="flex flex-col items-center text-center">
            <div class="relative mb-4">
              <div class="w-24 h-24 rounded-full overflow-hidden border-4 border-white shadow-lg">
                <img alt="ç”¨æˆ·å¤´åƒ" class="w-full h-full object-cover" id="avatarPreview" src="https://design.gemcoder.com/staticResource/echoAiSystemImages/6d889aef6e47f91e119c162f932286b6.png"/>
              </div>
              <label class="absolute -bottom-1 -right-1 bg-primary text-white rounded-full p-2 cursor-pointer shadow-md hover:bg-primary/90 transition-colors duration-200" for="avatarUpload">
                <i class="fas fa-camera text-sm"></i>
                <input accept="image/*" class="hidden" id="avatarUpload" type="file"/>
              </label>
            </div>
            <h3 class="text-lg font-semibold mb-1" id="userName">æœªè®¾ç½®</h3>
            <p class="text-secondary text-sm mb-4" id="userInfo">ç‚¹å‡»ç¼–è¾‘å®Œå–„ä¸ªäººä¿¡æ¯</p>
            
            <!-- ç”¨æˆ·çŠ¶æ€æŒ‡ç¤ºå™¨ -->
            <div class="w-full bg-gray-100 rounded-full h-2 mb-2">
              <div class="bg-gradient-to-r from-blue-500 to-purple-500 h-2 rounded-full" style="width: 60%"></div>
            </div>
            <p class="text-xs text-secondary">ä¿¡æ¯å®Œæ•´åº¦ 60%</p>
          </div>
        </div>

        <!-- å¿«æ·æ“ä½œå¡ç‰‡ -->
        <div class="bg-white/80 backdrop-blur-sm rounded-2xl p-6 card-shadow border border-white/20">
          <h2 class="text-lg font-semibold mb-4 flex items-center text-primary">
            <i class="fas fa-bolt mr-2"></i>
            å¿«æ·æ“ä½œ
          </h2>
          <div class="space-y-3">
            <a class="block w-full btn-secondary flex items-center justify-center py-3 rounded-lg" href="./index.html">
              <i class="fas fa-home mr-2"></i>
              è¿”å›é¦–é¡µ
            </a>
            <a class="block w-full btn-secondary flex items-center justify-center py-3 rounded-lg" href="./index.html#join">
              <i class="fas fa-edit mr-2"></i>
              æäº¤æŠ¥å
            </a>
            <a class="block w-full btn-primary flex items-center justify-center py-3 rounded-lg" href="./project-management.html">
              <i class="fas fa-project-diagram mr-2"></i>
              é¡¹ç›®ç®¡ç†
            </a>
          </div>
          
          <!-- æŠ¥åçŠ¶æ€ -->
          <div class="mt-4 p-4 bg-gradient-to-r from-green-50 to-emerald-50 rounded-xl border border-green-200">
            <h3 class="text-sm font-semibold text-green-800 mb-2">æœ€æ–°æŠ¥åçŠ¶æ€</h3>
            <div id="application-status" class="text-sm">
              <!-- æŠ¥åçŠ¶æ€å°†åœ¨è¿™é‡Œæ˜¾ç¤º -->
            </div>
          </div>
        </div>

        <!-- ç»Ÿè®¡ä¿¡æ¯å¡ç‰‡ -->
        <div class="bg-white/80 backdrop-blur-sm rounded-2xl p-6 card-shadow border border-white/20">
          <h2 class="text-lg font-semibold mb-6 flex items-center text-primary">
            <i class="fas fa-trophy mr-2"></i>
            æˆ‘çš„ç»Ÿè®¡
          </h2>
          <div id="statistics-content" class="space-y-4">
            <!-- åŠ è½½ä¸­çŠ¶æ€ -->
            <div class="flex items-center justify-center py-8">
              <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-primary"></div>
              <span class="ml-3 text-gray-600">åŠ è½½ç»Ÿè®¡æ•°æ®...</span>
            </div>
          </div>
        </div>
      </div>

      <!-- å³ä¾§ä¸»è¦å†…å®¹åŒºåŸŸ -->
      <div class="xl:col-span-3 space-y-6">
        
        <!-- æ ‡ç­¾é¡µå¯¼èˆª -->
        <div class="bg-white/80 backdrop-blur-sm rounded-2xl p-2 card-shadow border border-white/20">
          <div class="flex space-x-1" role="tablist">
            <button class="tab-btn active flex-1 py-3 px-4 rounded-xl text-sm font-medium transition-all duration-200" data-tab="profile">
              <i class="fas fa-user-edit mr-2"></i>
              ä¸ªäººä¿¡æ¯
            </button>
            <button class="tab-btn flex-1 py-3 px-4 rounded-xl text-sm font-medium transition-all duration-200" data-tab="invitations">
              <i class="fas fa-key mr-2"></i>
              é‚€è¯·ç 
            </button>
            <button class="tab-btn flex-1 py-3 px-4 rounded-xl text-sm font-medium transition-all duration-200" data-tab="security">
              <i class="fas fa-shield-alt mr-2"></i>
              å®‰å…¨è®¾ç½®
            </button>
          </div>
        </div>

        <!-- ä¸ªäººä¿¡æ¯æ ‡ç­¾é¡µ -->
        <div id="profile-tab" class="tab-content active">
          <div class="bg-white/80 backdrop-blur-sm rounded-2xl p-8 card-shadow border border-white/20">
            <h2 class="text-2xl font-semibold mb-6 flex items-center text-primary">
              <i class="fas fa-user-edit mr-3"></i>
              å®Œå–„ä¸ªäººä¿¡æ¯
            </h2>
            <form class="space-y-6" id="profileForm">
              <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2" for="name">
                    å§“å <span class="text-red-500">*</span>
                  </label>
                  <input class="w-full px-4 py-3 border border-gray-300 rounded-lg form-input-focus" id="name" name="name" placeholder="è¯·è¾“å…¥æ‚¨çš„å§“å" type="text"/>
                </div>
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2" for="studentId">
                    å­¦å· <span class="text-red-500">*</span>
                  </label>
                  <input class="w-full px-4 py-3 border border-gray-300 rounded-lg form-input-focus" id="studentId" name="studentId" placeholder="è¯·è¾“å…¥æ‚¨çš„å­¦å·" type="text"/>
                </div>
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2" for="major">
                    ä¸“ä¸š <span class="text-red-500">*</span>
                  </label>
                  <input class="w-full px-4 py-3 border border-gray-300 rounded-lg form-input-focus" id="major" name="major" placeholder="è¯·è¾“å…¥æ‚¨çš„ä¸“ä¸š" type="text"/>
                </div>
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2" for="grade">
                    å¹´çº§ <span class="text-red-500">*</span>
                  </label>
                  <select class="w-full px-4 py-3 border border-gray-300 rounded-lg form-input-focus" id="grade" name="grade">
                    <option value="">è¯·é€‰æ‹©å¹´çº§</option>
                    <option value="freshman">å¤§ä¸€</option>
                    <option value="sophomore">å¤§äºŒ</option>
                    <option value="junior">å¤§ä¸‰</option>
                    <option value="senior">å¤§å››</option>
                    <option value="graduate">ç ”ç©¶ç”Ÿ</option>
                  </select>
                </div>
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2" for="email">
                    é‚®ç®± <span class="text-red-500">*</span>
                  </label>
                  <input class="w-full px-4 py-3 border border-gray-300 rounded-lg form-input-focus" id="email" name="email" placeholder="è¯·è¾“å…¥æ‚¨çš„é‚®ç®±" type="email"/>
                </div>
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2" for="phone">
                    æ‰‹æœºå· <span class="text-red-500">*</span>
                  </label>
                  <input class="w-full px-4 py-3 border border-gray-300 rounded-lg form-input-focus" id="phone" name="phone" placeholder="è¯·è¾“å…¥æ‚¨çš„æ‰‹æœºå·" type="tel"/>
                </div>
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2" for="birthday">
                    ç”Ÿæ—¥ <span class="text-red-500">*</span>
                  </label>
                  <input class="w-full px-4 py-3 border border-gray-300 rounded-lg form-input-focus" id="birthday" name="birthday" type="date"/>
                </div>
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2" for="qq">
                    QQå·
                  </label>
                  <input class="w-full px-4 py-3 border border-gray-300 rounded-lg form-input-focus" id="qq" name="qq" placeholder="è¯·è¾“å…¥æ‚¨çš„QQå·" type="text"/>
                </div>
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2" for="introduction">
                  ä¸ªäººç®€ä»‹ <span class="text-red-500">*</span>
                </label>
                <textarea class="w-full px-4 py-3 border border-gray-300 rounded-lg form-input-focus" id="introduction" name="introduction" placeholder="è¯·ç®€è¦ä»‹ç»ä¸€ä¸‹è‡ªå·±ï¼Œå…´è¶£çˆ±å¥½ã€æŠ€æœ¯ç‰¹é•¿ç­‰..." rows="4"></textarea>
                <p class="text-xs text-secondary mt-2">
                  æœ€å¤šè¾“å…¥200ä¸ªå­—
                </p>
              </div>
              <div class="flex justify-end pt-4">
                <button class="btn-primary px-8 py-3 rounded-lg text-base font-medium" type="submit">
                  <i class="fas fa-save mr-2"></i>
                  ä¿å­˜ä¿¡æ¯
                </button>
              </div>
            </form>
          </div>
        </div>

        <!-- é‚€è¯·ç æ ‡ç­¾é¡µ -->
        <div id="invitations-tab" class="tab-content hidden">
          <div class="bg-white/80 backdrop-blur-sm rounded-2xl p-8 card-shadow border border-white/20">
            <h2 class="text-2xl font-semibold mb-6 flex items-center text-warning">
              <i class="fas fa-key mr-3"></i>
              é‚€è¯·ç ç®¡ç†
            </h2>
            <div id="invitation-notifications" class="space-y-4">
              <!-- é‚€è¯·ç é€šçŸ¥å°†åœ¨è¿™é‡ŒåŠ¨æ€æ˜¾ç¤º -->
              <div class="text-center py-12">
                <div class="text-gray-400 mb-4">
                  <i class="fas fa-search text-4xl"></i>
                </div>
                <p class="text-gray-600 text-lg">åŠ è½½ä¸­...</p>
              </div>
            </div>
          </div>
        </div>

        <!-- å®‰å…¨è®¾ç½®æ ‡ç­¾é¡µ -->
        <div id="security-tab" class="tab-content hidden">
          <div class="bg-white/80 backdrop-blur-sm rounded-2xl p-8 card-shadow border border-white/20">
            <h2 class="text-2xl font-semibold mb-6 flex items-center text-danger">
              <i class="fas fa-shield-alt mr-3"></i>
              å®‰å…¨è®¾ç½®
            </h2>
            <form class="space-y-6" id="passwordForm">
              <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2" for="oldPassword">
                    åŸå¯†ç 
                  </label>
                  <div class="relative">
                    <input class="w-full px-4 py-3 border border-gray-300 rounded-lg form-input-focus" id="oldPassword" name="oldPassword" placeholder="è¯·è¾“å…¥åŸå¯†ç " type="password"/>
                    <button class="toggle-password absolute right-3 top-1/2 transform -translate-y-1/2 text-secondary" data-target="oldPassword" type="button">
                      <i class="fas fa-eye-slash"></i>
                    </button>
                  </div>
                </div>
              </div>
              <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2" for="newPassword">
                    æ–°å¯†ç 
                  </label>
                  <div class="relative">
                    <input class="w-full px-4 py-3 border border-gray-300 rounded-lg form-input-focus" id="newPassword" name="newPassword" placeholder="è¯·è¾“å…¥æ–°å¯†ç " type="password"/>
                    <button class="toggle-password absolute right-3 top-1/2 transform -translate-y-1/2 text-secondary" data-target="newPassword" type="button">
                      <i class="fas fa-eye-slash"></i>
                    </button>
                  </div>
                </div>
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2" for="confirmPassword">
                    ç¡®è®¤æ–°å¯†ç 
                  </label>
                  <div class="relative">
                    <input class="w-full px-4 py-3 border border-gray-300 rounded-lg form-input-focus" id="confirmPassword" name="confirmPassword" placeholder="è¯·å†æ¬¡è¾“å…¥æ–°å¯†ç " type="password"/>
                    <button class="toggle-password absolute right-3 top-1/2 transform -translate-y-1/2 text-secondary" data-target="confirmPassword" type="button">
                      <i class="fas fa-eye-slash"></i>
                    </button>
                  </div>
                </div>
              </div>
              <div class="flex justify-end pt-4">
                <button class="btn-primary px-8 py-3 rounded-lg text-base font-medium" type="submit">
                  <i class="fas fa-key mr-2"></i>
                  ä¿®æ”¹å¯†ç 
                </button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </main>

  <!-- æˆåŠŸæç¤ºæ¨¡æ€æ¡† -->
  <div id="successModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center">
    <div class="bg-white rounded-2xl p-8 max-w-md mx-4 text-center">
      <div class="text-success text-4xl mb-4">
        <i class="fas fa-check-circle"></i>
      </div>
      <h3 class="text-xl font-semibold mb-2">æ“ä½œæˆåŠŸ</h3>
      <p id="successMessage" class="text-secondary mb-6">ä¿¡æ¯å·²ä¿å­˜</p>
      <button onclick="closeSuccessModal()" class="btn-primary px-6 py-2 rounded-lg">
        ç¡®å®š
      </button>
    </div>
  </div>

  <!-- æ¶ˆæ¯æç¤ºæ¡† -->
  <div class="fixed top-4 right-4 px-6 py-3 rounded-lg shadow-lg transform translate-x-full transition-transform duration-300 flex items-center z-50" id="toast">
   <i class="mr-2" id="toastIcon">
   </i>
   <span id="toastMessage">
    æç¤ºæ¶ˆæ¯
   </span>
  </div>
  <script>
   // å…¨å±€å˜é‡
   let currentUser = null;

   // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–
   document.addEventListener('DOMContentLoaded', function() {
     console.log('ä¸ªäººä¸­å¿ƒé¡µé¢åŠ è½½å®Œæˆ');
     checkAuthStatus();
     initPasswordToggle();
     initFormSubmissions();
     initAvatarUpload();
     initQuickActions();
     initTabSwitch(); // åˆå§‹åŒ–æ ‡ç­¾é¡µåˆ‡æ¢
   });

   // æ£€æŸ¥è®¤è¯çŠ¶æ€
   async function checkAuthStatus() {
     try {
       console.log('æ£€æŸ¥è®¤è¯çŠ¶æ€...');
       const { data: { user }, error: userError } = await window.supabase.auth.getUser();
       
       if (userError) {
         console.error('è·å–ç”¨æˆ·ä¿¡æ¯å¤±è´¥:', userError);
         showToast('è®¤è¯å¤±è´¥ï¼Œè¯·é‡æ–°ç™»å½•', 'error');
         setTimeout(() => {
           window.location.href = './index.html';
         }, 2000);
         return;
       }
       
       if (user) {
         console.log('ç”¨æˆ·å·²ç™»å½•:', user.email);
         currentUser = user;
               loadUserProfile();
      loadApplicationStatus();
      loadUserStatistics();
       } else {
         console.log('ç”¨æˆ·æœªç™»å½•ï¼Œè·³è½¬åˆ°é¦–é¡µ');
         showToast('è¯·å…ˆç™»å½•', 'error');
         setTimeout(() => {
           window.location.href = './index.html';
         }, 2000);
       }
     } catch (error) {
       console.error('æ£€æŸ¥è®¤è¯çŠ¶æ€å¤±è´¥:', error);
       showToast('è®¤è¯æ£€æŸ¥å¤±è´¥ï¼Œè¯·é‡æ–°ç™»å½•', 'error');
       setTimeout(() => {
         window.location.href = './index.html';
       }, 2000);
     }
   }

   // åˆå§‹åŒ–å¯†ç æ˜¾ç¤º/éšè—åˆ‡æ¢
   function initPasswordToggle() {
     const toggleButtons = document.querySelectorAll('.toggle-password');
     toggleButtons.forEach(function(button) {
       button.addEventListener('click', function() {
         const targetId = button.getAttribute('data-target');
         const passwordInput = document.getElementById(targetId);
         const icon = button.querySelector('i');
         if (passwordInput.type === 'password') {
           passwordInput.type = 'text';
           icon.classList.remove('fa-eye-slash');
           icon.classList.add('fa-eye');
         } else {
           passwordInput.type = 'password';
           icon.classList.remove('fa-eye');
           icon.classList.add('fa-eye-slash');
         }
       });
     });
   }

   // åˆå§‹åŒ–è¡¨å•æäº¤äº‹ä»¶
   function initFormSubmissions() {
     // ä¸ªäººä¿¡æ¯è¡¨å•æäº¤
     const profileForm = document.getElementById('profileForm');
     profileForm.addEventListener('submit', function(e) {
       e.preventDefault();
       saveUserProfile();
     });

     // å¯†ç ä¿®æ”¹è¡¨å•æäº¤
     const passwordForm = document.getElementById('passwordForm');
     passwordForm.addEventListener('submit', function(e) {
       e.preventDefault();
       changePassword();
     });
   }

   // åˆå§‹åŒ–å¤´åƒä¸Šä¼ 
   function initAvatarUpload() {
     const avatarUpload = document.getElementById('avatarUpload');
     const avatarPreview = document.getElementById('avatarPreview');
     
     avatarUpload.addEventListener('change', async function(e) {
       const file = e.target.files[0];
       if (file) {
         try {
           console.log('å¼€å§‹ä¸Šä¼ å¤´åƒæ–‡ä»¶:', {
             fileName: file.name,
             fileSize: file.size,
             fileType: file.type
           });
           
           // æ–‡ä»¶å¤§å°æ£€æŸ¥ï¼ˆ5MBé™åˆ¶ï¼‰
           if (file.size > 5 * 1024 * 1024) {
             showToast('å¤´åƒæ–‡ä»¶å¤§å°ä¸èƒ½è¶…è¿‡5MB', 'error');
             return;
           }
           
           // æ–‡ä»¶ç±»å‹æ£€æŸ¥
           if (!file.type.startsWith('image/')) {
             showToast('è¯·é€‰æ‹©å›¾ç‰‡æ–‡ä»¶', 'error');
             return;
           }
           
           // ç”Ÿæˆå®‰å…¨çš„æ–‡ä»¶å
           const fileExt = file.name.split('.').pop().toLowerCase();
           const timestamp = Date.now();
           const fileName = `avatar_${currentUser.id}_${timestamp}.${fileExt}`;
           const filePath = `avatars/${fileName}`;
           
           console.log('å‡†å¤‡ä¸Šä¼ åˆ°è·¯å¾„:', filePath);
           
           // ä¸Šä¼ åˆ° Supabase Storage
           const { data, error } = await window.supabase.storage
             .from('tyjk-files')
             .upload(filePath, file, { 
               upsert: true,
               cacheControl: '3600'
             });
           
           if (error) {
             console.error('æ–‡ä»¶ä¸Šä¼ å¤±è´¥:', error);
             console.error('é”™è¯¯è¯¦æƒ…:', {
               message: error.message,
               code: error.code,
               statusCode: error.statusCode,
               details: error.details
             });
             showToast('å¤´åƒä¸Šä¼ å¤±è´¥: ' + error.message, 'error');
             return;
           }
           
           console.log('æ–‡ä»¶ä¸Šä¼ æˆåŠŸ:', data);
           
           // è·å–å…¬å¼€URL
           const { data: urlData } = window.supabase.storage
             .from('tyjk-files')
             .getPublicUrl(filePath);
           
           console.log('è·å–åˆ°å…¬å¼€URL:', urlData.publicUrl);
           
           // æ›´æ–°é¢„è§ˆ
           avatarPreview.src = urlData.publicUrl;
           
           // æ›´æ–°é¡µé¢ä¸Šæ‰€æœ‰å¤´åƒæ˜¾ç¤º
           updateAvatarDisplay(urlData.publicUrl);
           
           showToast('å¤´åƒä¸Šä¼ æˆåŠŸ', 'success');
           
           // ä¿å­˜å¤´åƒURLåˆ°ç”¨æˆ·ä¿¡æ¯
           await saveAvatarUrl(urlData.publicUrl);
         } catch (error) {
           console.error('å¤´åƒä¸Šä¼ è¿‡ç¨‹å‘ç”Ÿå¼‚å¸¸:', error);
           console.error('å¼‚å¸¸è¯¦æƒ…:', {
             message: error.message,
             stack: error.stack,
             name: error.name
           });
           showToast('å¤´åƒä¸Šä¼ å¤±è´¥ï¼Œè¯·é‡è¯•', 'error');
         }
       }
     });
   }

   // æ›´æ–°å¤´åƒæ˜¾ç¤º
   function updateAvatarDisplay(avatarUrl) {
     console.log('å¼€å§‹æ›´æ–°å¤´åƒæ˜¾ç¤º:', avatarUrl);
     
     // æ›´æ–°å¤´åƒé¢„è§ˆ
     const avatarPreview = document.getElementById('avatarPreview');
     if (avatarPreview) {
       console.log('æ‰¾åˆ°avatarPreviewå…ƒç´ ï¼Œæ›´æ–°src');
       avatarPreview.src = avatarUrl;
       avatarPreview.onload = function() {
         console.log('å¤´åƒå›¾ç‰‡åŠ è½½æˆåŠŸ');
       };
       avatarPreview.onerror = function() {
         console.error('å¤´åƒå›¾ç‰‡åŠ è½½å¤±è´¥:', avatarUrl);
       };
     } else {
       console.error('æœªæ‰¾åˆ°avatarPreviewå…ƒç´ ');
     }
     
     // æ›´æ–°æ‰€æœ‰å¤´åƒå…ƒç´ ï¼ˆå¦‚æœæœ‰å…¶ä»–å¤´åƒæ˜¾ç¤ºï¼‰
     const avatarElements = document.querySelectorAll('.avatar-image, .user-avatar, #avatarPreview');
     console.log('æ‰¾åˆ°å¤´åƒå…ƒç´ æ•°é‡:', avatarElements.length);
     avatarElements.forEach((element, index) => {
       console.log(`æ›´æ–°å¤´åƒå…ƒç´  ${index}:`, element.id || element.className);
       element.src = avatarUrl;
       element.style.display = 'block';
     });
     
     // éšè—é»˜è®¤å¤´åƒå ä½ç¬¦ï¼ˆå¦‚æœæœ‰ï¼‰
     const placeholderElements = document.querySelectorAll('.avatar-placeholder');
     placeholderElements.forEach(element => {
       element.style.display = 'none';
     });
     
     console.log('å¤´åƒæ˜¾ç¤ºå·²æ›´æ–°:', avatarUrl);
   }

   // åˆå§‹åŒ–å¿«æ·æ“ä½œæŒ‰é’®
   function initQuickActions() {
     // é€€å‡ºç™»å½•æŒ‰é’®
     const logoutBtn = document.getElementById('logoutBtn');
     logoutBtn.addEventListener('click', async function() {
       if (confirm('ç¡®å®šè¦é€€å‡ºç™»å½•å—ï¼Ÿ')) {
         try {
           await window.supabase.auth.signOut();
           showToast('å·²é€€å‡ºç™»å½•', 'success');
           setTimeout(() => {
             window.location.href = './index.html';
           }, 1000);
         } catch (error) {
           console.error('é€€å‡ºç™»å½•å¤±è´¥:', error);
           showToast('é€€å‡ºç™»å½•å¤±è´¥', 'error');
         }
       }
     });
   }

   // åŠ è½½ç”¨æˆ·ä¸ªäººèµ„æ–™
   async function loadUserProfile() {
     try {
       console.log('åŠ è½½ç”¨æˆ·ä¿¡æ¯...');
       const userName = currentUser.user_metadata?.name || '';
       const userEmail = currentUser.email || '';
       
       document.getElementById('user-name').textContent = userName || userEmail;
       document.getElementById('userName').textContent = userName || 'æœªè®¾ç½®';
       document.getElementById('name').value = userName;
       document.getElementById('email').value = userEmail;
       
       // åŠ è½½è¯¦ç»†ä¿¡æ¯
       const { data: profile, error } = await window.supabase
         .from('user_profiles')
         .select('*')
         .eq('user_id', currentUser.id)
         .single();
       
       if (profile) {
         console.log('æ‰¾åˆ°ç”¨æˆ·è¯¦ç»†ä¿¡æ¯:', profile);
         fillProfileForm(profile);
         
         // å¦‚æœæœ‰å¤´åƒURLï¼Œæ˜¾ç¤ºå¤´åƒ
         if (profile.avatar_url) {
           updateAvatarDisplay(profile.avatar_url);
         }
       } else {
         console.log('æœªæ‰¾åˆ°ç”¨æˆ·è¯¦ç»†ä¿¡æ¯ï¼Œä½¿ç”¨é»˜è®¤å€¼');
       }
       
       // åŠ è½½é‚€è¯·ç é€šçŸ¥
       await loadInvitationNotifications();
     } catch (error) {
       console.error('åŠ è½½ç”¨æˆ·ä¿¡æ¯å¤±è´¥:', error);
     }
   }

   // å¡«å……è¡¨å•æ•°æ®
   function fillProfileForm(profile) {
     document.getElementById('studentId').value = profile.student_id || '';
     document.getElementById('major').value = profile.major || '';
     document.getElementById('grade').value = profile.grade || '';
     document.getElementById('phone').value = profile.phone || '';
     document.getElementById('birthday').value = profile.birthday || '';
     document.getElementById('qq').value = profile.qq || '';
     document.getElementById('introduction').value = profile.introduction || '';
     
     // æ›´æ–°å¤´åƒæ˜¾ç¤º
     if (profile.avatar_url) {
       updateAvatarDisplay(profile.avatar_url);
     }
     
     // æ›´æ–°ç”¨æˆ·ä¿¡æ¯æ˜¾ç¤º
     updateUserInfoDisplay(profile);
   }

   // æ›´æ–°ç”¨æˆ·ä¿¡æ¯æ˜¾ç¤º
   function updateUserInfoDisplay(profile) {
     const userNameElement = document.getElementById('userName');
     const userInfoElement = document.getElementById('userInfo');
     
     if (profile.name) {
       userNameElement.textContent = profile.name;
       
       // æ„å»ºç”¨æˆ·ä¿¡æ¯æ–‡æœ¬
       const userInfoText = [];
       if (profile.student_id) userInfoText.push(profile.student_id);
       if (profile.major) userInfoText.push(profile.major);
       if (profile.grade) userInfoText.push(profile.grade);
       
       userInfoElement.textContent = userInfoText.join(' | ') || 'ä¸ªäººä¿¡æ¯å·²å®Œå–„';
     }
   }

   // ä¿å­˜ç”¨æˆ·ä¸ªäººèµ„æ–™
   async function saveUserProfile() {
     try {
       const userProfile = {
         user_id: currentUser.id,
         name: document.getElementById('name').value.trim(),
         student_id: document.getElementById('studentId').value.trim(),
         major: document.getElementById('major').value.trim(),
         grade: document.getElementById('grade').value,
         email: document.getElementById('email').value.trim(),
         phone: document.getElementById('phone').value.trim(),
         birthday: document.getElementById('birthday').value,
         qq: document.getElementById('qq').value.trim(),
         introduction: document.getElementById('introduction').value.trim(),
         updated_at: new Date().toISOString()
       };

       // ç®€å•éªŒè¯
       if (!userProfile.name) {
         showToast('è¯·è¾“å…¥å§“å', 'error');
         return;
       }

       // ä¿å­˜åˆ° Supabase
       // å…ˆæ£€æŸ¥æ˜¯å¦å·²å­˜åœ¨è®°å½•
       const { data: existingProfile } = await window.supabase
         .from('user_profiles')
         .select('id')
         .eq('user_id', currentUser.id)
         .single();

       let error;
       if (existingProfile) {
         // æ›´æ–°ç°æœ‰è®°å½•
         const { error: updateError } = await window.supabase
           .from('user_profiles')
           .update(userProfile)
           .eq('user_id', currentUser.id);
         error = updateError;
       } else {
         // æ’å…¥æ–°è®°å½•
         const { error: insertError } = await window.supabase
           .from('user_profiles')
           .insert(userProfile);
         error = insertError;
       }

       if (error) {
         console.error('ä¿å­˜ç”¨æˆ·ä¿¡æ¯å¤±è´¥:', error);
         showToast('ä¿å­˜å¤±è´¥: ' + error.message, 'error');
       } else {
         showToast('ä¸ªäººä¿¡æ¯ä¿å­˜æˆåŠŸ', 'success');
         updateUserInfoDisplay(userProfile);
       }
     } catch (error) {
       console.error('ä¿å­˜ç”¨æˆ·ä¿¡æ¯å¤±è´¥:', error);
       showToast('ä¿å­˜å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•', 'error');
     }
   }

   // ä¿å­˜å¤´åƒURL
   async function saveAvatarUrl(avatarUrl) {
     try {
       console.log('ä¿å­˜å¤´åƒURL:', avatarUrl);
       
       // å…ˆæ£€æŸ¥æ˜¯å¦å·²å­˜åœ¨è®°å½•
       const { data: existingProfile } = await window.supabase
         .from('user_profiles')
         .select('id')
         .eq('user_id', currentUser.id)
         .single();

       let error;
       if (existingProfile) {
         // æ›´æ–°ç°æœ‰è®°å½•
         const { error: updateError } = await window.supabase
           .from('user_profiles')
           .update({
             avatar_url: avatarUrl,
             updated_at: new Date().toISOString()
           })
           .eq('user_id', currentUser.id);
         error = updateError;
       } else {
         // æ’å…¥æ–°è®°å½•
         const { error: insertError } = await window.supabase
           .from('user_profiles')
           .insert({
             user_id: currentUser.id,
             avatar_url: avatarUrl,
             updated_at: new Date().toISOString()
           });
         error = insertError;
       }

       if (error) {
         console.error('ä¿å­˜å¤´åƒURLå¤±è´¥:', error);
         showToast('å¤´åƒä¿å­˜å¤±è´¥', 'error');
       } else {
         console.log('å¤´åƒURLä¿å­˜æˆåŠŸ');
         showToast('å¤´åƒä¿å­˜æˆåŠŸ', 'success');
       }
     } catch (error) {
       console.error('ä¿å­˜å¤´åƒURLå¤±è´¥:', error);
       showToast('å¤´åƒä¿å­˜å¤±è´¥', 'error');
     }
   }

   // ä¿®æ”¹å¯†ç 
   async function changePassword() {
     const oldPassword = document.getElementById('oldPassword').value;
     const newPassword = document.getElementById('newPassword').value;
     const confirmPassword = document.getElementById('confirmPassword').value;

     // ç®€å•éªŒè¯
     if (!oldPassword) {
       showToast('è¯·è¾“å…¥åŸå¯†ç ', 'error');
       return;
     }
     if (!newPassword) {
       showToast('è¯·è¾“å…¥æ–°å¯†ç ', 'error');
       return;
     }
     if (newPassword !== confirmPassword) {
       showToast('ä¸¤æ¬¡è¾“å…¥çš„æ–°å¯†ç ä¸ä¸€è‡´', 'error');
       return;
     }
     if (newPassword.length < 6) {
       showToast('æ–°å¯†ç é•¿åº¦ä¸èƒ½å°‘äº6ä½', 'error');
       return;
     }

     try {
       // å…ˆç”¨æ—§å¯†ç ç™»å½•éªŒè¯
       const { error: signInError } = await window.supabase.auth.signInWithPassword({
         email: currentUser.email,
         password: oldPassword
       });
       
       if (signInError) {
         showToast('åŸå¯†ç é”™è¯¯', 'error');
         return;
       }

       // ä¿®æ”¹å¯†ç 
       const { error } = await window.supabase.auth.updateUser({ password: newPassword });
       
       if (error) {
         showToast('ä¿®æ”¹å¯†ç å¤±è´¥: ' + error.message, 'error');
       } else {
         showToast('å¯†ç ä¿®æ”¹æˆåŠŸï¼Œè¯·é‡æ–°ç™»å½•', 'success');
         
         // é‡ç½®å¯†ç è¡¨å•
         document.getElementById('passwordForm').reset();
         
         // 2ç§’åè‡ªåŠ¨é€€å‡ºç™»å½•
         setTimeout(async function() {
           await window.supabase.auth.signOut();
           window.location.href = './index.html';
         }, 2000);
       }
     } catch (error) {
       console.error('ä¿®æ”¹å¯†ç å¤±è´¥:', error);
       showToast('ä¿®æ”¹å¯†ç å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•', 'error');
     }
   }

   // åŠ è½½æŠ¥åçŠ¶æ€
   async function loadApplicationStatus() {
     try {
       console.log('åŠ è½½æŠ¥åçŠ¶æ€...');
       
       // ä»applicationsè¡¨è·å–æŠ¥åè®°å½•
       console.log('ä»applicationsè¡¨è·å–æ•°æ®...');
       const { data: applications, error: applicationsError } = await window.supabase
         .from('applications')
         .select('*')
         .eq('email', currentUser.email)
         .order('created_at', { ascending: false });
       
       console.log('applicationsè¡¨æŸ¥è¯¢ç»“æœ:', { data: applications, error: applicationsError });
       
       if (applicationsError) {
         console.error('åŠ è½½applicationsè¡¨æ•°æ®å¤±è´¥:', applicationsError);
         throw applicationsError;
       }
       
       const container = document.getElementById('application-status');
       
       // æ˜¾ç¤ºapplicationsè¡¨çš„æ•°æ®
       if (applications && applications.length > 0) {
         console.log('æ˜¾ç¤ºapplicationsè¡¨æ•°æ®');
         const latest = applications[0];
         const statusText = getStatusText(latest.status);
         const statusColor = getStatusColor(latest.status);
         
         container.innerHTML = `
           <div class="text-sm">
             <div class="flex justify-between items-center mb-2">
               <span class="font-medium">æœ€æ–°æŠ¥å</span>
               <span class="px-2 py-1 rounded-full text-xs ${statusColor}">${statusText}</span>
             </div>
             <div class="text-gray-600">
               <div>éƒ¨é—¨ï¼š${latest.department}</div>
               <div>æ—¶é—´ï¼š${new Date(latest.created_at).toLocaleDateString()}</div>
             </div>
           </div>
         `;
       } else {
         console.log('æ²¡æœ‰ä»»ä½•æŠ¥åè®°å½•');
         // æ²¡æœ‰ä»»ä½•æŠ¥åè®°å½•
         container.innerHTML = `
           <div class="text-center py-4">
             <p class="text-gray-600 mb-2">æ‚¨è¿˜æ²¡æœ‰æäº¤è¿‡æŠ¥åç”³è¯·</p>
             <a href="./index.html#join" class="text-primary hover:underline">ç«‹å³æŠ¥å</a>
           </div>
         `;
       }
     } catch (error) {
       console.error('åŠ è½½æŠ¥åçŠ¶æ€å¤±è´¥:', error);
       const container = document.getElementById('application-status');
       container.innerHTML = `
         <div class="text-center py-4">
           <p class="text-red-600 mb-2">åŠ è½½å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•</p>
           <p class="text-xs text-gray-500">é”™è¯¯ä¿¡æ¯: ${error.message}</p>
         </div>
       `;
     }
   }

   function getStatusText(status) {
     const statusMap = {
       pending: 'å¾…å®¡æ ¸',
       approved: 'å·²é€šè¿‡',
       rejected: 'å·²æ‹’ç»'
     };
     return statusMap[status] || status;
   }

   function getStatusColor(status) {
     const colorMap = {
       pending: 'bg-yellow-100 text-yellow-800',
       approved: 'bg-green-100 text-green-800',
       rejected: 'bg-red-100 text-red-800'
     };
     return colorMap[status] || 'bg-gray-100 text-gray-800';
   }

   // åŠ è½½é‚€è¯·ç é€šçŸ¥
   async function loadInvitationNotifications() {
     try {
       console.log('åŠ è½½é‚€è¯·ç é€šçŸ¥...');
       const container = document.getElementById('invitation-notifications');
       
       // è·å–ç”¨æˆ·çš„é‚€è¯·ç 
       const { data: invitations, error } = await window.supabase
         .from('user_invitation_codes')
         .select('*')
         .eq('user_id', currentUser.id)
         .order('created_at', { ascending: false });
       
       if (error) {
         console.error('åŠ è½½é‚€è¯·ç å¤±è´¥:', error);
         container.innerHTML = `
           <div class="text-center py-4">
             <div class="text-red-400 mb-2">
               <i class="fas fa-exclamation-circle text-xl"></i>
             </div>
             <p class="text-gray-600">åŠ è½½å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•</p>
           </div>
         `;
         return;
       }
       
       if (!invitations || invitations.length === 0) {
         // æ²¡æœ‰é‚€è¯·ç 
         container.innerHTML = `
           <div class="text-center py-6">
             <div class="text-gray-400 mb-3">
               <i class="fas fa-search text-3xl"></i>
             </div>
             <p class="text-gray-600 mb-2">æš‚æ— é‚€è¯·ç é€šçŸ¥</p>
             <p class="text-sm text-gray-500">å½“ç®¡ç†å‘˜ä¸ºæ‚¨ç”Ÿæˆé‚€è¯·ç æ—¶ï¼Œæ‚¨å°†åœ¨è¿™é‡Œæ”¶åˆ°é€šçŸ¥</p>
             <div class="mt-4 space-x-2">
               <button onclick="loadInvitationNotifications()" class="text-primary hover:underline text-sm">
                 <i class="fas fa-refresh mr-1"></i>åˆ·æ–°
               </button>
               <button onclick="contactAdmin()" class="text-primary hover:underline text-sm">
                 <i class="fas fa-envelope mr-1"></i>è”ç³»ç®¡ç†å‘˜
               </button>
             </div>
           </div>
         `;
         return;
       }
       
       // æ˜¾ç¤ºé‚€è¯·ç é€šçŸ¥
       const invitation = invitations[0]; // æ˜¾ç¤ºæœ€æ–°çš„é‚€è¯·ç 
                   const isExpired = new Date(invitation.expires_at) < new Date();
            const expiresInDays = Math.ceil((new Date(invitation.expires_at) - new Date()) / (1000 * 60 * 60 * 24));
            const isExpiringSoon = expiresInDays <= 1 && expiresInDays > 0; // è°ƒæ•´ä¸º1å¤©å†…å³å°†è¿‡æœŸ
       
       let notificationHtml = '';
       
       if (isExpired) {
         // å·²è¿‡æœŸçš„é‚€è¯·ç 
         notificationHtml = `
           <div class="border border-red-200 bg-red-50 rounded-lg p-4">
             <div class="flex items-start justify-between mb-3">
               <div class="flex items-center">
                 <i class="fas fa-exclamation-triangle text-red-500 mr-2"></i>
                 <span class="font-semibold text-red-700">é‚€è¯·ç å·²è¿‡æœŸ</span>
               </div>
               <span class="text-xs text-gray-500">${new Date(invitation.created_at).toLocaleDateString()}</span>
             </div>
             <div class="bg-white border border-red-200 rounded p-3 mb-3">
               <div class="flex items-center justify-between">
                 <span class="font-mono text-lg">${invitation.invitation_code}</span>
                 <span class="text-red-500 text-sm">(å·²è¿‡æœŸ)</span>
               </div>
             </div>
             <div class="text-sm text-gray-600 mb-3">
               <div>ğŸ“… è¿‡æœŸæ—¶é—´: ${new Date(invitation.expires_at).toLocaleDateString()}</div>
               <div>ğŸ’¡ å¦‚éœ€ç»§ç»­ä½¿ç”¨ï¼Œè¯·è”ç³»ç®¡ç†å‘˜ç”³è¯·æ–°çš„é‚€è¯·ç </div>
             </div>
             <div class="flex space-x-2">
               <button onclick="contactAdmin()" class="bg-purple-500 text-white px-3 py-1 rounded text-sm hover:bg-purple-600 transition-colors">
                 <i class="fas fa-envelope mr-1"></i>è”ç³»ç®¡ç†å‘˜
               </button>
               <button onclick="requestNewInvitation()" class="bg-orange-500 text-white px-3 py-1 rounded text-sm hover:bg-orange-600 transition-colors">
                 <i class="fas fa-plus mr-1"></i>ç”³è¯·æ–°é‚€è¯·ç 
               </button>
             </div>
           </div>
         `;
       } else if (isExpiringSoon) {
         // å³å°†è¿‡æœŸçš„é‚€è¯·ç 
         notificationHtml = `
           <div class="border border-yellow-200 bg-yellow-50 rounded-lg p-4">
             <div class="flex items-start justify-between mb-3">
               <div class="flex items-center">
                 <i class="fas fa-clock text-yellow-600 mr-2"></i>
                 <span class="font-semibold text-yellow-700">é‚€è¯·ç å³å°†è¿‡æœŸ</span>
               </div>
               <span class="text-xs text-gray-500">${new Date(invitation.created_at).toLocaleDateString()}</span>
             </div>
             <div class="bg-white border border-yellow-200 rounded p-3 mb-3">
               <div class="flex items-center justify-between">
                 <span class="font-mono text-lg">${invitation.invitation_code}</span>
                 <button onclick="copyInvitationCode('${invitation.invitation_code}')" class="text-blue-500 hover:text-blue-700 text-sm">
                   <i class="fas fa-copy mr-1"></i>å¤åˆ¶
                 </button>
               </div>
             </div>
             <div class="text-sm text-gray-600 mb-3">
               <div>ğŸ“… è¿‡æœŸæ—¶é—´: ${new Date(invitation.expires_at).toLocaleDateString()}</div>
               <div>â° å‰©ä½™æ—¶é—´: ${expiresInDays}å¤©</div>
             </div>
             <div class="flex space-x-2">
               <button onclick="useInvitationCode()" class="bg-green-500 text-white px-3 py-1 rounded text-sm hover:bg-green-600 transition-colors">
                 <i class="fas fa-arrow-right mr-1"></i>ç«‹å³ä½¿ç”¨
               </button>
               <button onclick="requestExtension()" class="bg-yellow-500 text-black px-3 py-1 rounded text-sm hover:bg-yellow-600 transition-colors">
                 <i class="fas fa-clock mr-1"></i>ç”³è¯·å»¶æœŸ
               </button>
             </div>
           </div>
         `;
       } else {
         // æœ‰æ•ˆçš„é‚€è¯·ç 
         notificationHtml = `
           <div class="border border-green-200 bg-green-50 rounded-lg p-4">
             <div class="flex items-start justify-between mb-3">
               <div class="flex items-center">
                 <i class="fas fa-check-circle text-green-500 mr-2"></i>
                 <span class="font-semibold text-green-700">é¡¹ç›®ç®¡ç†é‚€è¯·ç </span>
               </div>
               <span class="text-xs text-gray-500">${new Date(invitation.created_at).toLocaleDateString()}</span>
             </div>
             <div class="bg-white border border-green-200 rounded p-3 mb-3">
               <div class="flex items-center justify-between">
                 <span class="font-mono text-lg">${invitation.invitation_code}</span>
                 <button onclick="copyInvitationCode('${invitation.invitation_code}')" class="text-blue-500 hover:text-blue-700 text-sm">
                   <i class="fas fa-copy mr-1"></i>å¤åˆ¶
                 </button>
               </div>
             </div>
             <div class="text-sm text-gray-600 mb-3">
               <div>ğŸ“… æœ‰æ•ˆæœŸè‡³: ${new Date(invitation.expires_at).toLocaleDateString()}</div>
               <div>ğŸ¯ æƒé™èŒƒå›´: é¡¹ç›®ç®¡ç†åŠŸèƒ½</div>
             </div>
             <div class="flex space-x-2">
               <button onclick="useInvitationCode()" class="bg-green-500 text-white px-3 py-1 rounded text-sm hover:bg-green-600 transition-colors">
                 <i class="fas fa-arrow-right mr-1"></i>ç«‹å³ä½¿ç”¨
               </button>
               <button onclick="viewLater()" class="bg-gray-500 text-white px-3 py-1 rounded text-sm hover:bg-gray-600 transition-colors">
                 <i class="fas fa-eye mr-1"></i>ç¨åæŸ¥çœ‹
               </button>
             </div>
           </div>
         `;
       }
       
       container.innerHTML = notificationHtml;
       
     } catch (error) {
       console.error('åŠ è½½é‚€è¯·ç é€šçŸ¥å¤±è´¥:', error);
       const container = document.getElementById('invitation-notifications');
       container.innerHTML = `
         <div class="text-center py-4">
           <div class="text-red-400 mb-2">
             <i class="fas fa-exclamation-circle text-xl"></i>
           </div>
           <p class="text-gray-600">åŠ è½½å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•</p>
         </div>
       `;
     }
   }

   // å¤åˆ¶é‚€è¯·ç 
   async function copyInvitationCode(code) {
     try {
       await navigator.clipboard.writeText(code);
       showToast('é‚€è¯·ç å·²å¤åˆ¶åˆ°å‰ªè´´æ¿', 'success');
     } catch (error) {
       console.error('å¤åˆ¶å¤±è´¥:', error);
       showToast('å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶', 'error');
     }
   }

   // ä½¿ç”¨é‚€è¯·ç ï¼ˆè·³è½¬åˆ°é¡¹ç›®ç®¡ç†é¡µé¢ï¼‰
   function useInvitationCode() {
     showToast('æ­£åœ¨è·³è½¬åˆ°é¡¹ç›®ç®¡ç†é¡µé¢...', 'info');
     setTimeout(() => {
       // ç›´æ¥è·³è½¬åˆ°é¡¹ç›®ç®¡ç†é¡µé¢
       window.location.href = './project-management.html';
     }, 1000);
   }

   // ç¨åæŸ¥çœ‹
   function viewLater() {
     showToast('æ‚¨å¯ä»¥åœ¨éœ€è¦æ—¶éšæ—¶ä½¿ç”¨é‚€è¯·ç ', 'info');
   }

   // ç”³è¯·å»¶æœŸ
   function requestExtension() {
     showToast('å»¶æœŸç”³è¯·å·²å‘é€ç»™ç®¡ç†å‘˜', 'info');
   }

   // ç”³è¯·æ–°é‚€è¯·ç 
   function requestNewInvitation() {
     showToast('æ–°é‚€è¯·ç ç”³è¯·å·²å‘é€ç»™ç®¡ç†å‘˜', 'info');
   }

   // è”ç³»ç®¡ç†å‘˜
   function contactAdmin() {
     showContactAdminModal();
   }

   // æ ‡ç­¾é¡µåˆ‡æ¢åŠŸèƒ½
   function initTabSwitch() {
     const tabBtns = document.querySelectorAll('.tab-btn');
     const tabContents = document.querySelectorAll('.tab-content');

     tabBtns.forEach(btn => {
       btn.addEventListener('click', function() {
         const targetTab = this.getAttribute('data-tab');
         
         // ç§»é™¤æ‰€æœ‰æ´»åŠ¨çŠ¶æ€
         tabBtns.forEach(b => b.classList.remove('active', 'bg-primary', 'text-white'));
         tabContents.forEach(c => c.classList.add('hidden'));
         
         // æ·»åŠ æ´»åŠ¨çŠ¶æ€
         this.classList.add('active', 'bg-primary', 'text-white');
         document.getElementById(targetTab + '-tab').classList.remove('hidden');
       });
     });
   }

   // æ˜¾ç¤ºæç¤ºæ¶ˆæ¯
   function showToast(message, type = 'info') {
     const toast = document.getElementById('toast');
     const toastMessage = document.getElementById('toastMessage');
     const toastIcon = document.getElementById('toastIcon');

     // è®¾ç½®æ¶ˆæ¯å†…å®¹
     toastMessage.textContent = message;

     // è®¾ç½®å›¾æ ‡å’Œæ ·å¼
     toastIcon.className = '';
     toast.className = 'fixed top-4 right-4 px-6 py-3 rounded-lg shadow-lg transform translate-x-full transition-transform duration-300 flex items-center z-50';
     
     switch (type) {
       case 'success':
         toast.classList.add('bg-green-500', 'text-white');
         toastIcon.classList.add('fas', 'fa-check-circle');
         break;
       case 'error':
         toast.classList.add('bg-red-500', 'text-white');
         toastIcon.classList.add('fas', 'fa-exclamation-circle');
         break;
       case 'warning':
         toast.classList.add('bg-yellow-500', 'text-white');
         toastIcon.classList.add('fas', 'fa-exclamation-triangle');
         break;
       case 'info':
       default:
         toast.classList.add('bg-blue-500', 'text-white');
         toastIcon.classList.add('fas', 'fa-info-circle');
         break;
     }

     // æ˜¾ç¤ºæç¤ºæ¡†
     toast.classList.remove('translate-x-full');
     toast.classList.add('translate-x-0');

     // 3ç§’åè‡ªåŠ¨éšè—
     setTimeout(function() {
       toast.classList.remove('translate-x-0');
       toast.classList.add('translate-x-full');
     }, 3000);
   }

   // å…³é—­æˆåŠŸæ¨¡æ€æ¡†
   window.closeSuccessModal = function() {
     document.getElementById('successModal').classList.add('hidden');
   };

   // æ˜¾ç¤ºæˆåŠŸæ¨¡æ€æ¡†
   function showSuccessModal(message) {
     document.getElementById('successMessage').textContent = message;
     document.getElementById('successModal').classList.remove('hidden');
   }

   // å¡«å……ä¸ªäººä¿¡æ¯è¡¨å•
   function fillProfileForm(profile) {
     document.getElementById('studentId').value = profile.student_id || '';
     document.getElementById('major').value = profile.major || '';
     document.getElementById('grade').value = profile.grade || '';
     document.getElementById('phone').value = profile.phone || '';
     document.getElementById('birthday').value = profile.birthday || '';
     document.getElementById('qq').value = profile.qq || '';
     document.getElementById('introduction').value = profile.introduction || '';
   }

   // ä¿å­˜ç”¨æˆ·ä¸ªäººä¿¡æ¯
   async function saveUserProfile() {
     try {
       const formData = new FormData(document.getElementById('profileForm'));
       const profileData = {
         user_id: currentUser.id,
         name: formData.get('name'),
         student_id: formData.get('studentId'),
         major: formData.get('major'),
         grade: formData.get('grade'),
         email: formData.get('email'),
         phone: formData.get('phone'),
         birthday: formData.get('birthday'),
         qq: formData.get('qq'),
         introduction: formData.get('introduction'),
         updated_at: new Date().toISOString()
       };

       const { data, error } = await window.supabase
         .from('user_profiles')
         .upsert(profileData, { onConflict: 'user_id' });

       if (error) {
         console.error('ä¿å­˜ä¸ªäººä¿¡æ¯å¤±è´¥:', error);
         showToast('ä¿å­˜å¤±è´¥: ' + error.message, 'error');
         return;
       }

       showSuccessModal('ä¸ªäººä¿¡æ¯ä¿å­˜æˆåŠŸï¼');
       showToast('ä¸ªäººä¿¡æ¯å·²ä¿å­˜', 'success');
       
       // æ›´æ–°é¡µé¢æ˜¾ç¤º
       document.getElementById('userName').textContent = profileData.name || 'æœªè®¾ç½®';
       document.getElementById('user-name').textContent = profileData.name || currentUser.email;
       
       // åˆ·æ–°ç»Ÿè®¡æ•°æ®
       await loadUserStatistics();
       
     } catch (error) {
       console.error('ä¿å­˜ä¸ªäººä¿¡æ¯å¤±è´¥:', error);
       showToast('ä¿å­˜å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•', 'error');
     }
   }

   // ä¿®æ”¹å¯†ç 
   async function changePassword() {
     try {
       const oldPassword = document.getElementById('oldPassword').value;
       const newPassword = document.getElementById('newPassword').value;
       const confirmPassword = document.getElementById('confirmPassword').value;

       if (!oldPassword || !newPassword || !confirmPassword) {
         showToast('è¯·å¡«å†™æ‰€æœ‰å¯†ç å­—æ®µ', 'error');
         return;
       }

       if (newPassword !== confirmPassword) {
         showToast('æ–°å¯†ç ä¸ç¡®è®¤å¯†ç ä¸ä¸€è‡´', 'error');
         return;
       }

       if (newPassword.length < 6) {
         showToast('æ–°å¯†ç é•¿åº¦è‡³å°‘6ä½', 'error');
         return;
       }

       const { error } = await window.supabase.auth.updateUser({
         password: newPassword
       });

       if (error) {
         console.error('ä¿®æ”¹å¯†ç å¤±è´¥:', error);
         showToast('ä¿®æ”¹å¯†ç å¤±è´¥: ' + error.message, 'error');
         return;
       }

       showSuccessModal('å¯†ç ä¿®æ”¹æˆåŠŸï¼');
       showToast('å¯†ç å·²ä¿®æ”¹', 'success');
       
       // æ¸…ç©ºè¡¨å•
       document.getElementById('passwordForm').reset();
       
     } catch (error) {
       console.error('ä¿®æ”¹å¯†ç å¤±è´¥:', error);
       showToast('ä¿®æ”¹å¯†ç å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•', 'error');
     }
   }

   // ä¿å­˜å¤´åƒURL
   async function saveAvatarUrl(avatarUrl) {
     try {
       const { error } = await window.supabase
         .from('user_profiles')
         .upsert({
           user_id: currentUser.id,
           avatar_url: avatarUrl,
           updated_at: new Date().toISOString()
         }, { onConflict: 'user_id' });

       if (error) {
         console.error('ä¿å­˜å¤´åƒURLå¤±è´¥:', error);
       }
     } catch (error) {
       console.error('ä¿å­˜å¤´åƒURLå¤±è´¥:', error);
     }
   }



    // åŠ è½½ç”¨æˆ·ç»Ÿè®¡æ•°æ®
    async function loadUserStatistics() {
      try {
        console.log('åŠ è½½ç”¨æˆ·ç»Ÿè®¡æ•°æ®...');
        
        // è·å–ç”¨æˆ·å‚ä¸çš„é¡¹ç›®æ•°é‡
        const { data: userProjects, error: projectsError } = await window.supabase
          .from('project_members')
          .select('project_id')
          .eq('user_id', currentUser.id)
          .eq('status', 'active');

        if (projectsError) {
          console.error('åŠ è½½ç”¨æˆ·é¡¹ç›®å¤±è´¥:', projectsError);
          displayStatistics({
            total_projects: 0,
            national_awards: 0,
            provincial_awards: 0,
            school_awards: 0,
            other_awards: 0
          });
          return;
        }

        const projectIds = userProjects.map(p => p.project_id);
        console.log('ç”¨æˆ·å‚ä¸çš„é¡¹ç›®ID:', projectIds);

        // è·å–ç”¨æˆ·å‚ä¸çš„é¡¹ç›®ä¸­ç”³è¯·äº†å¥–é¡¹çš„é¡¹ç›®
        const { data: awardProjects, error: awardError } = await window.supabase
          .from('projects')
          .select('award_level')
          .in('id', projectIds)
          .not('award_level', 'is', null);

        if (awardError) {
          console.error('åŠ è½½å¥–é¡¹æ•°æ®å¤±è´¥:', awardError);
          displayStatistics({
            total_projects: projectIds.length,
            national_awards: 0,
            provincial_awards: 0,
            school_awards: 0,
            other_awards: 0
          });
          return;
        }

        console.log('è·å–åˆ°çš„å¥–é¡¹æ•°æ®:', awardProjects);

        // è®¡ç®—ç»Ÿè®¡æ•°æ®
        const stats = {
          total_projects: projectIds.length,
          national_awards: awardProjects.filter(p => p.award_level === 'national').length,
          provincial_awards: awardProjects.filter(p => p.award_level === 'provincial').length,
          school_awards: awardProjects.filter(p => p.award_level === 'school').length,
          other_awards: awardProjects.filter(p => p.award_level === 'other').length
        };

        console.log('è®¡ç®—å¾—å‡ºçš„ç»Ÿè®¡æ•°æ®:', stats);
        displayStatistics(stats);

      } catch (error) {
        console.error('åŠ è½½ç»Ÿè®¡æ•°æ®å¤±è´¥:', error);
        // æ˜¾ç¤ºé»˜è®¤æ•°æ®
        displayStatistics({
          total_projects: 0,
          national_awards: 0,
          provincial_awards: 0,
          school_awards: 0,
          other_awards: 0
        });
      }
    }

    // æ˜¾ç¤ºç»Ÿè®¡æ•°æ®
    function displayStatistics(stats) {
      const container = document.getElementById('statistics-content');
      
      container.innerHTML = `
        <!-- å‚ä¸é¡¹ç›® -->
        <div class="flex items-center justify-between p-3 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg border border-blue-100">
          <div class="flex items-center">
            <i class="fas fa-project-diagram text-blue-600 mr-3 text-lg"></i>
            <span class="text-sm font-medium text-gray-700">å‚ä¸é¡¹ç›®</span>
          </div>
          <span class="text-xl font-bold text-blue-600">${stats.total_projects || 0}</span>
        </div>
        
        <!-- å›½å®¶çº§å¥–é¡¹ -->
        <div class="flex items-center justify-between p-3 bg-gradient-to-r from-red-50 to-pink-50 rounded-lg border border-red-100">
          <div class="flex items-center">
            <i class="fas fa-crown text-red-600 mr-3 text-lg"></i>
            <span class="text-sm font-medium text-gray-700">å›½å®¶çº§å¥–é¡¹</span>
          </div>
          <span class="text-xl font-bold text-red-600">${stats.national_awards || 0}</span>
        </div>
        
        <!-- çœçº§å¥–é¡¹ -->
        <div class="flex items-center justify-between p-3 bg-gradient-to-r from-blue-50 to-cyan-50 rounded-lg border border-blue-100">
          <div class="flex items-center">
            <i class="fas fa-medal text-blue-600 mr-3 text-lg"></i>
            <span class="text-sm font-medium text-gray-700">çœçº§å¥–é¡¹</span>
          </div>
          <span class="text-xl font-bold text-blue-600">${stats.provincial_awards || 0}</span>
        </div>
        
        <!-- æ ¡çº§å¥–é¡¹ -->
        <div class="flex items-center justify-between p-3 bg-gradient-to-r from-green-50 to-emerald-50 rounded-lg border border-green-100">
          <div class="flex items-center">
            <i class="fas fa-award text-green-600 mr-3 text-lg"></i>
            <span class="text-sm font-medium text-gray-700">æ ¡çº§å¥–é¡¹</span>
          </div>
          <span class="text-xl font-bold text-green-600">${stats.school_awards || 0}</span>
        </div>
        
        <!-- å…¶ä»–å¥–é¡¹ -->
        <div class="flex items-center justify-between p-3 bg-gradient-to-r from-purple-50 to-violet-50 rounded-lg border border-purple-100">
          <div class="flex items-center">
            <i class="fas fa-star text-purple-600 mr-3 text-lg"></i>
            <span class="text-sm font-medium text-gray-700">å…¶ä»–å¥–é¡¹</span>
          </div>
          <span class="text-xl font-bold text-purple-600">${stats.other_awards || 0}</span>
        </div>
      `;
    }

    // æ˜¾ç¤ºè”ç³»ç®¡ç†å‘˜æ¨¡æ€æ¡†
    function showContactAdminModal() {
      document.getElementById('contact-admin-modal').classList.remove('hidden');
    }

    // å…³é—­è”ç³»ç®¡ç†å‘˜æ¨¡æ€æ¡†
    function closeContactAdminModal() {
      document.getElementById('contact-admin-modal').classList.add('hidden');
    }

    // å¤åˆ¶é‚®ç®±åˆ°å‰ªè´´æ¿
    function copyEmail() {
      const email = '767997302@qq.com';
      navigator.clipboard.writeText(email).then(function() {
        // æ˜¾ç¤ºæˆåŠŸæç¤º
        const button = event.target.closest('button');
        const originalText = button.innerHTML;
        button.innerHTML = '<i class="fas fa-check mr-2"></i>å·²å¤åˆ¶';
        button.classList.remove('bg-blue-600', 'hover:bg-blue-700');
        button.classList.add('bg-green-600', 'hover:bg-green-700');
        
        setTimeout(() => {
          button.innerHTML = originalText;
          button.classList.remove('bg-green-600', 'hover:bg-green-700');
          button.classList.add('bg-blue-600', 'hover:bg-blue-700');
        }, 2000);
      }).catch(function(err) {
        console.error('å¤åˆ¶å¤±è´¥:', err);
        alert('å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶é‚®ç®±åœ°å€');
      });
    }

    // å¤åˆ¶ç”µè¯åˆ°å‰ªè´´æ¿
    function copyPhone() {
      const phone = '18532206167';
      navigator.clipboard.writeText(phone).then(function() {
        // æ˜¾ç¤ºæˆåŠŸæç¤º
        const button = event.target.closest('button');
        const originalText = button.innerHTML;
        button.innerHTML = '<i class="fas fa-check mr-2"></i>å·²å¤åˆ¶';
        button.classList.remove('bg-green-600', 'hover:bg-green-700');
        button.classList.add('bg-blue-600', 'hover:bg-blue-700');
        
        setTimeout(() => {
          button.innerHTML = originalText;
          button.classList.remove('bg-blue-600', 'hover:bg-blue-700');
          button.classList.add('bg-green-600', 'hover:bg-green-700');
        }, 2000);
      }).catch(function(err) {
        console.error('å¤åˆ¶å¤±è´¥:', err);
        alert('å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶ç”µè¯å·ç ');
      });
    }

    // æ˜¾ç¤ºç»Ÿè®¡æ•°æ®
    function displayStatistics(stats) {
      const container = document.getElementById('statistics-content');
      
      container.innerHTML = `
        <!-- å‚ä¸é¡¹ç›® -->
        <div class="flex items-center justify-between p-3 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg border border-blue-100">
          <div class="flex items-center">
            <i class="fas fa-project-diagram text-blue-600 mr-3 text-lg"></i>
            <span class="text-sm font-medium text-gray-700">å‚ä¸é¡¹ç›®</span>
          </div>
          <span class="text-xl font-bold text-blue-600">${stats.total_projects || 0}</span>
        </div>
        
        <!-- å›½å®¶çº§å¥–é¡¹ -->
        <div class="flex items-center justify-between p-3 bg-gradient-to-r from-red-50 to-pink-50 rounded-lg border border-red-100">
          <div class="flex items-center">
            <i class="fas fa-crown text-red-600 mr-3 text-lg"></i>
            <span class="text-sm font-medium text-gray-700">å›½å®¶çº§å¥–é¡¹</span>
          </div>
          <span class="text-xl font-bold text-red-600">${stats.national_awards || 0}</span>
        </div>
        
        <!-- çœçº§å¥–é¡¹ -->
        <div class="flex items-center justify-between p-3 bg-gradient-to-r from-blue-50 to-cyan-50 rounded-lg border border-blue-100">
          <div class="flex items-center">
            <i class="fas fa-medal text-blue-600 mr-3 text-lg"></i>
            <span class="text-sm font-medium text-gray-700">çœçº§å¥–é¡¹</span>
          </div>
          <span class="text-xl font-bold text-blue-600">${stats.provincial_awards || 0}</span>
        </div>
        
        <!-- æ ¡çº§å¥–é¡¹ -->
        <div class="flex items-center justify-between p-3 bg-gradient-to-r from-green-50 to-emerald-50 rounded-lg border border-green-100">
          <div class="flex items-center">
            <i class="fas fa-award text-green-600 mr-3 text-lg"></i>
            <span class="text-sm font-medium text-gray-700">æ ¡çº§å¥–é¡¹</span>
          </div>
          <span class="text-xl font-bold text-green-600">${stats.school_awards || 0}</span>
        </div>
        
        <!-- å…¶ä»–å¥–é¡¹ -->
        <div class="flex items-center justify-between p-3 bg-gradient-to-r from-purple-50 to-violet-50 rounded-lg border border-purple-100">
          <div class="flex items-center">
            <i class="fas fa-star text-purple-600 mr-3 text-lg"></i>
            <span class="text-sm font-medium text-gray-700">å…¶ä»–å¥–é¡¹</span>
          </div>
          <span class="text-xl font-bold text-purple-600">${stats.other_awards || 0}</span>
        </div>
      `;
    }

    // åˆ·æ–°ç»Ÿè®¡æ•°æ®
    async function refreshStatistics() {
      try {
        // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
        const container = document.getElementById('statistics-content');
        container.innerHTML = `
          <div class="flex items-center justify-center py-8">
            <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-primary"></div>
            <span class="ml-3 text-gray-600">åˆ·æ–°ç»Ÿè®¡æ•°æ®...</span>
          </div>
        `;
        
        // é‡æ–°åŠ è½½ç»Ÿè®¡æ•°æ®
        await loadUserStatistics();
        
        // æ˜¾ç¤ºæˆåŠŸæç¤º
        showToast('ç»Ÿè®¡æ•°æ®å·²åˆ·æ–°', 'success');
      } catch (error) {
        console.error('åˆ·æ–°ç»Ÿè®¡æ•°æ®å¤±è´¥:', error);
        showToast('åˆ·æ–°å¤±è´¥ï¼Œè¯·é‡è¯•', 'error');
      }
    }

    // æ˜¾ç¤ºè”ç³»ç®¡ç†å‘˜æ¨¡æ€æ¡†
    function showContactAdminModal() {
      document.getElementById('contact-admin-modal').classList.remove('hidden');
    }

    // å…³é—­è”ç³»ç®¡ç†å‘˜æ¨¡æ€æ¡†
    function closeContactAdminModal() {
      document.getElementById('contact-admin-modal').classList.add('hidden');
    }

    // å°†å‡½æ•°æš´éœ²åˆ°å…¨å±€ä½œç”¨åŸŸ
    window.refreshStatistics = refreshStatistics;
  </script>

  <!-- è”ç³»ç®¡ç†å‘˜æ¨¡æ€æ¡† -->
  <div id="contact-admin-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
    <div class="bg-white rounded-2xl p-8 max-w-md w-full mx-4 shadow-xl">
      <div class="flex justify-between items-center mb-6">
        <h3 class="text-2xl font-bold text-gray-800">è”ç³»ç®¡ç†å‘˜</h3>
        <button onclick="closeContactAdminModal()" class="text-gray-400 hover:text-gray-600 transition-colors">
          <i class="fas fa-times text-xl"></i>
        </button>
      </div>
      
      <div class="text-center mb-6">
        <div class="w-16 h-16 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center mx-auto mb-4">
          <i class="fas fa-headset text-white text-2xl"></i>
        </div>
        <h4 class="text-lg font-semibold text-gray-900 mb-2">éœ€è¦å¸®åŠ©ï¼Ÿ</h4>
        <p class="text-gray-600">è¯·è”ç³»ç®¡ç†å‘˜è·å–é‚€è¯·ç æˆ–è§£å†³å…¶ä»–é—®é¢˜</p>
      </div>

      <div class="space-y-4 mb-6">
        <div class="bg-blue-50 rounded-lg p-4 border border-blue-200">
          <div class="flex items-center">
            <i class="fas fa-envelope text-blue-600 mr-3 text-lg"></i>
            <div>
              <p class="text-sm font-medium text-gray-700">é‚®ç®±è”ç³»</p>
              <p class="text-blue-600 font-semibold">767997302@qq.com</p>
            </div>
          </div>
        </div>
        
        <div class="bg-green-50 rounded-lg p-4 border border-green-200">
          <div class="flex items-center">
            <i class="fas fa-phone text-green-600 mr-3 text-lg"></i>
            <div>
              <p class="text-sm font-medium text-gray-700">ç”µè¯è”ç³»</p>
              <p class="text-green-600 font-semibold">18532206167</p>
            </div>
          </div>
        </div>
      </div>

      <div class="bg-yellow-50 rounded-lg p-4 border border-yellow-200 mb-6">
        <div class="flex items-start">
          <i class="fas fa-info-circle text-yellow-600 mr-3 mt-1"></i>
          <div>
            <p class="text-sm font-medium text-gray-700 mb-1">æ¸©é¦¨æç¤º</p>
            <p class="text-sm text-gray-600">è”ç³»ç®¡ç†å‘˜æ—¶ï¼Œè¯·æä¾›æ‚¨çš„æ³¨å†Œé‚®ç®±å’Œå§“åï¼Œä»¥ä¾¿å¿«é€Ÿå¤„ç†æ‚¨çš„è¯·æ±‚ã€‚</p>
          </div>
        </div>
      </div>

      <div class="flex space-x-3">
        <button onclick="copyEmail()" class="flex-1 bg-blue-600 hover:bg-blue-700 text-white font-medium py-3 px-4 rounded-lg transition-colors">
          <i class="fas fa-copy mr-2"></i>å¤åˆ¶é‚®ç®±
        </button>
        <button onclick="copyPhone()" class="flex-1 bg-green-600 hover:bg-green-700 text-white font-medium py-3 px-4 rounded-lg transition-colors">
          <i class="fas fa-phone mr-2"></i>å¤åˆ¶ç”µè¯
        </button>
      </div>

      <div class="mt-4 text-center">
        <button onclick="closeContactAdminModal()" class="text-gray-500 hover:text-gray-700 font-medium">
          å…³é—­
        </button>
      </div>
    </div>
  </div>
 </body>
</html>
